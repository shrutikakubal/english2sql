# english2sql
English to SQL converter powered by EvaDB

This project aims to provide an AI powered model that will generate SQL statements based on the user’s requests in natural language.

We connect to EvaDB and the Postgres database, where the schema of each table is extracted and stored. This schema includes column names, data types, lengths, and other characteristics like nullable/non-nullable, autogenerated fields, etc. The schema information is stored in the 'SUMMARY' table.
The 'SUMMARY' table serves as context for the AI model (gpt-3.5turbo) to answer questions accurately. We use EvaDB's CHATGPT function to ask questions, using custom prompts tailored for each type of query.
Users can provide either the exact table name or ask for the most relevant one. If the table name is provided, its schema is used as context for the AI model. 
If not, we run a vector embedding-based similarity search to find the most relevant tables, and the LLM generates SQL statements accordingly.
The project utilizes the Marvin library to call different functions based on the user's request. Marvin is an AI-powered classifier that employs logit bias to return classifications.

In the second iteration of the project, an extended version of EvaDB's ChatGPT function has been added. This function returns the token usage of each query (prompt tokens, completion tokens and total used). The function can also act as a classifier. We limit the output tokens to 1, so that the LLM is forced to return one word answers.
The logit-bias parameter is used to make the LLM output only a finite set of answers. We maximize the bias of the classification labels, so that they are picked every time. This approach is efficient as only one token is outputted. 

•	The user can ask questions which are classified as select/insert/update or other questions.

• The user can provide the exact table name for faster and more accurate responses.

• In case of a SELECT, the user is asked if they want to execute the statement. In the prompt, we ask the LLM to wrap the SQL statement in ```sql<statement>```. If the user wishes to execute, the statement is automatically parsed from the model’s output and executed by EvaDB.

•	After each response the user is asked if they want to ask another question. Once they answer ‘no’, the session ends.
